from metahq_core.ontology.graph import Graph
from metahq_core.ontology.loader import RelationsLoader
from metahq_core.util.supported import get_onto_families, get_ontology_files

file = get_onto_families("mondo")["relations"]
obo = get_ontology_files("mondo")

ancestors = RelationsLoader(file).get_ancestors(subset=["MONDO:0004994"])
descendants = RelationsLoader(file).get_descendants(subset=["MONDO:0004994"])

assert ancestors["MONDO:0004994"] == [
    "MONDO:0000001",
    "MONDO:0002081",
    "MONDO:0003939",
    "MONDO:0004994",
    "MONDO:0004995",
    "MONDO:0005267",
    "MONDO:0700096",
]
assert descendants["MONDO:0004994"] == [
    "MONDO:0000241",
    "MONDO:0000591",
    "MONDO:0000727",
    "MONDO:0000908",
    "MONDO:0001113",
    "MONDO:0001114",
    "MONDO:0001707",
    "MONDO:0002815",
    "MONDO:0002824",
    "MONDO:0004485",
    "MONDO:0004496",
    "MONDO:0004582",
    "MONDO:0004802",
    "MONDO:0004803",
    "MONDO:0004851",
    "MONDO:0004941",
    "MONDO:0004994",
    "MONDO:0005021",
    "MONDO:0005045",
    "MONDO:0005110",
    "MONDO:0005200",
    "MONDO:0005201",
    "MONDO:0005217",
    "MONDO:0005418",
    "MONDO:0005491",
    "MONDO:0006643",
    "MONDO:0006746",
    "MONDO:0007152",
    "MONDO:0007171",
    "MONDO:0007265",
    "MONDO:0007266",
    "MONDO:0007267",
    "MONDO:0007268",
    "MONDO:0007269",
    "MONDO:0007270",
    "MONDO:0007534",
    "MONDO:0007893",
    "MONDO:0007938",
    "MONDO:0008034",
    "MONDO:0008056",
    "MONDO:0008104",
    "MONDO:0008406",
    "MONDO:0008409",
    "MONDO:0008647",
    "MONDO:0008723",
    "MONDO:0008911",
    "MONDO:0009026",
    "MONDO:0009265",
    "MONDO:0009282",
    "MONDO:0009290",
    "MONDO:0009301",
    "MONDO:0009677",
    "MONDO:0010226",
    "MONDO:0010311",
    "MONDO:0010400",
    "MONDO:0010401",
    "MONDO:0010542",
    "MONDO:0010543",
    "MONDO:0010679",
    "MONDO:0010680",
    "MONDO:0010765",
    "MONDO:0010771",
    "MONDO:0010772",
    "MONDO:0010787",
    "MONDO:0010788",
    "MONDO:0010790",
    "MONDO:0010946",
    "MONDO:0010951",
    "MONDO:0011003",
    "MONDO:0011017",
    "MONDO:0011028",
    "MONDO:0011076",
    "MONDO:0011094",
    "MONDO:0011095",
    "MONDO:0011188",
    "MONDO:0011189",
    "MONDO:0011400",
    "MONDO:0011403",
    "MONDO:0011423",
    "MONDO:0011425",
    "MONDO:0011451",
    "MONDO:0011459",
    "MONDO:0011460",
    "MONDO:0011482",
    "MONDO:0011484",
    "MONDO:0011531",
    "MONDO:0011541",
    "MONDO:0011567",
    "MONDO:0011702",
    "MONDO:0011758",
    "MONDO:0011766",
    "MONDO:0011831",
    "MONDO:0011840",
    "MONDO:0011843",
    "MONDO:0011895",
    "MONDO:0011899",
    "MONDO:0011968",
    "MONDO:0012062",
    "MONDO:0012111",
    "MONDO:0012112",
    "MONDO:0012173",
    "MONDO:0012180",
    "MONDO:0012285",
    "MONDO:0012306",
    "MONDO:0012362",
    "MONDO:0012364",
    "MONDO:0012371",
    "MONDO:0012434",
    "MONDO:0012506",
    "MONDO:0012547",
    "MONDO:0012556",
    "MONDO:0012557",
    "MONDO:0012667",
    "MONDO:0012669",
    "MONDO:0012684",
    "MONDO:0012690",
    "MONDO:0012691",
    "MONDO:0012699",
    "MONDO:0012704",
    "MONDO:0012714",
    "MONDO:0012744",
    "MONDO:0012745",
    "MONDO:0012746",
    "MONDO:0012799",
    "MONDO:0012804",
    "MONDO:0012808",
    "MONDO:0012900",
    "MONDO:0013030",
    "MONDO:0013049",
    "MONDO:0013066",
    "MONDO:0013071",
    "MONDO:0013072",
    "MONDO:0013120",
    "MONDO:0013147",
    "MONDO:0013168",
    "MONDO:0013186",
    "MONDO:0013195",
    "MONDO:0013197",
    "MONDO:0013198",
    "MONDO:0013200",
    "MONDO:0013211",
    "MONDO:0013261",
    "MONDO:0013262",
    "MONDO:0013339",
    "MONDO:0013369",
    "MONDO:0013371",
    "MONDO:0013373",
    "MONDO:0013379",
    "MONDO:0013380",
    "MONDO:0013410",
    "MONDO:0013412",
    "MONDO:0013455",
    "MONDO:0013474",
    "MONDO:0013475",
    "MONDO:0013476",
    "MONDO:0013477",
    "MONDO:0013479",
    "MONDO:0013664",
    "MONDO:0013677",
    "MONDO:0013848",
    "MONDO:0013852",
    "MONDO:0013968",
    "MONDO:0014042",
    "MONDO:0014051",
    "MONDO:0014073",
    "MONDO:0014095",
    "MONDO:0014100",
    "MONDO:0014112",
    "MONDO:0014113",
    "MONDO:0014114",
    "MONDO:0014143",
    "MONDO:0014152",
    "MONDO:0014163",
    "MONDO:0014329",
    "MONDO:0014396",
    "MONDO:0014480",
    "MONDO:0014634",
    "MONDO:0014667",
    "MONDO:0014668",
    "MONDO:0014676",
    "MONDO:0014691",
    "MONDO:0014693",
    "MONDO:0014788",
    "MONDO:0014883",
    "MONDO:0015280",
    "MONDO:0015281",
    "MONDO:0015470",
    "MONDO:0015487",
    "MONDO:0015691",
    "MONDO:0016097",
    "MONDO:0016330",
    "MONDO:0016332",
    "MONDO:0016333",
    "MONDO:0016338",
    "MONDO:0016340",
    "MONDO:0016342",
    "MONDO:0016345",
    "MONDO:0016424",
    "MONDO:0016475",
    "MONDO:0016476",
    "MONDO:0016477",
    "MONDO:0016478",
    "MONDO:0016547",
    "MONDO:0016587",
    "MONDO:0016830",
    "MONDO:0016899",
    "MONDO:0017336",
    "MONDO:0017401",
    "MONDO:0017402",
    "MONDO:0017403",
    "MONDO:0017694",
    "MONDO:0017816",
    "MONDO:0017817",
    "MONDO:0017833",
    "MONDO:0017834",
    "MONDO:0017835",
    "MONDO:0018008",
    "MONDO:0018018",
    "MONDO:0018084",
    "MONDO:0018332",
    "MONDO:0018333",
    "MONDO:0018485",
    "MONDO:0018901",
    "MONDO:0018920",
    "MONDO:0018932",
    "MONDO:0018997",
    "MONDO:0019018",
    "MONDO:0019122",
    "MONDO:0019150",
    "MONDO:0019158",
    "MONDO:0019159",
    "MONDO:0019438",
    "MONDO:0019439",
    "MONDO:0019441",
    "MONDO:0019875",
    "MONDO:0019923",
    "MONDO:0020297",
    "MONDO:0020336",
    "MONDO:0020531",
    "MONDO:0020712",
    "MONDO:0021569",
    "MONDO:0022519",
    "MONDO:0022653",
    "MONDO:0023006",
    "MONDO:0023161",
    "MONDO:0023182",
    "MONDO:0023232",
    "MONDO:0024573",
    "MONDO:0030062",
    "MONDO:0030300",
    "MONDO:0030317",
    "MONDO:0030330",
    "MONDO:0030366",
    "MONDO:0030679",
    "MONDO:0030680",
    "MONDO:0030701",
    "MONDO:0030887",
    "MONDO:0032592",
    "MONDO:0032786",
    "MONDO:0032839",
    "MONDO:0033669",
    "MONDO:0035646",
    "MONDO:0041259",
    "MONDO:0054588",
    "MONDO:0054637",
    "MONDO:0054838",
    "MONDO:0100059",
    "MONDO:0100082",
    "MONDO:0500000",
    "MONDO:0700073",
    "MONDO:0700074",
    "MONDO:0700076",
    "MONDO:0800318",
    "MONDO:0800346",
    "MONDO:0800347",
    "MONDO:0800350",
    "MONDO:0800351",
    "MONDO:0800367",
    "MONDO:0800368",
    "MONDO:0800371",
    "MONDO:0800441",
    "MONDO:0859358",
    "MONDO:0859372",
    "MONDO:0859381",
    "MONDO:8000015",
]


# onto = Graph.from_obo(obo, ontology="mondo")
#
# print(onto.ancestors("MONDO:0004994"))
# print(onto.descendants("MONDO:0004994"))
